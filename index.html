<!doctype html>
<html>

<head>
<title>
C++の歴史
</title>

		<meta charset="utf-8" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
</head>

<body>
<div class="reveal">
<div class="slides">

<section>

<section>
<h1>C++の歴史</h1>

<p>
江添亮<br />
<a href="http://cpplover.blogspot.jp/">http://cpplover.blogspot.jp/</a><br />
boostcpp@gmail.com<br />
<a href="https://twitter.com/EzoeRyou">@EzoeRyou</a>
</p>

<p>
GFDL 1.3 with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
</p>
    </section>

    <section id="themes" >
					<h2>Themes</h2>
					<p>

						<a href="?theme=sky#/themes">Sky</a> -
						<a href="?theme=beige#/themes">Beige</a> -
						<a href="?theme=simple#/themes">Simple</a> -
						<a href="?theme=serif#/themes">Serif</a> -
						<a href="?theme=night#/themes">Night</a> -
						<a href="?#/themes">Default</a>
					</p>
    </section>

    <section id="transitions">
        <h2>Transition Styles</h2>
        <p>

            <a href="?transition=cube#/transitions">Cube</a> -
            <a href="?transition=page#/transitions">Page</a> -
            <a href="?transition=concave#/transitions">Concave</a> -
            <a href="?transition=zoom#/transitions">Zoom</a> -
            <a href="?transition=linear#/transitions">Linear</a> -
            <a href="?transition=fade#/transitions">Fade</a> -
            <a href="?transition=none#/transitions">None</a> -
            <a href="?#/transitions">Default</a>
        </p>
</section>

</section>

<section id="cpp-author">
<h2>C++の原作者</h2>

<p>
Bjarne Stroustrup
</p>

<p>
C++のオリジナルの設計者にして最初の実装者
</p>

</section>

<section id="pre-history">
<h2>1979年</h2>

<p>
Stroustrup、ケンブリッジで博士号を取得するべく研究中
</p>

<p>
分散システム上で動作するソフトウェアの研究
</p>

<p>
実証のため、大規模なシミュレーターを書かなければならない
</p>

<p>
Simulaで書いた
</p>

</section>

<section>
<h2>Simulaの利点</h2>

<p>
「Simulaで書くのは最高だった」
</p>

<p>
クラス機能によって、問題をそのままコードに落とし込める
</p>

<p>
クラス自体がコルーチンのように並列実行できる
</p>

<p>
強い型システムとコンパイル時警告
</p>
</section>

<section>
<h2>Simulaの欠点</h2>

<p>
分割コンパイルしてリンクが遅い
</p>

<p>
実行速度が遅い
</p>

<p>
メモリ確保がすべてGC
</p>

<p>
これらを無効にする方法がない
</p>
</section>

<section>
<h3>リンクが遅い</h3>

<p>
僅かな部分をコンパイルして、<br>
コンパイル済みのバイナリへのリンクが遅い
</p>

<p>
すべてのソースコードを単一のファイルで<br>
コンパイルするのに比べて、30倍遅い
</p>
</section>

<section>
<h3>ガベージ・コレクション</h3>

<p>
メモリ確保はすべてGC
</p>

<p>
明示的にリソース管理をしているのにすべてGC
</p>

<p>
実行時間の80%がGCで浪費
</p>
</section>

<section>
<h2>研究中断の危機</h2>

<p>
シミュレーターが遅すぎて使い物にならない
</p>

<p>
このままでは研究が実証できない
</p>

<p>
Stroustrupの博士号が危うい
</p>


</section>

<section>
<h2>書き直し</h2>

<p>
BCPLで全面的に書きなおした
</p>
</section>

<section id="bcpl">
<h2>BCPL</h2>

<p>
「BCPLに比べれば、Cがとても高級な言語に見えた」
</p>

<p>
型がない
</p>

<p>
コンパイル時チェックもない
</p>

<p>
何もない
</p>
</section>

<section>
<h2>速い実行</h2>

<p>
BCPLはとても速い
</p>

<p>
リンクが速い
</p>

<p>
実行速度も速い
</p>

<p>
シミュレーターは動いた
</p>

</section>


<section>
<h2>Stroustrupの誓い</h2>

<p>
二度とまともなツールなしに大規模な問題に取り組まないと誓う
</p>

<ul>

<li>
良きツールはSimulaの表現力を持つべきである
</li>

<li>
良きツールはBCPLのリンク速度を持つべきである
</li>

<li>
良きツールは他の言語のバイナリとリンクして使えるべきである
</li>

<li>
良きツールはBCPLの実行速度を持つべきである
</li>

</ul>
</section>

<section>
<h2>その後</h2>

<p>
Stroustrupは、なんとか博士号を取得。
</p>
<p>
ケンブリッジを去る
</p>

<p>
Bell Labで職を得る
</p>
</section>

<section>
<h2>Bell Labの特徴</h2>

<p>
十分なコンピューター資源が与えられる
</p>

<p>
優秀な同僚(K&amp;Rも在籍)との議論が推奨される
</p>

<p>
仕事内容、「なにか面白いことをやれ」
</p>

<p>
結果は一年後に報告
</p>
</section>

<section>
<h2>研究</h2>

<p>
ネットワークに繋がれたコンピューター群<br>
その上で動作するUNIXカーネルについて
</p>

<ul>
<li>
分散カーネルのネットワークトラフィックの解析
</li>

<li>
カーネルのモジュール化
</li>
</ul>

</section>

<section>
<h2>誓い</h2>

<p>
まともなツールなしでは<br>
二度と大規模な問題には挑まない
</p>

<p>
まともなツールを作る
</p>
</section>

<section>
<h2>Cpre</h2>

<p>
C言語に独自のプリプロセッサーを組み合わせたツール
</p>

<p>
C言語にSimulaのクラス機能をもたらす
</p>
</section>

<section>
<h2>C with Classes</h2>


<p>
名前を変えてツールから言語へ
</p>

<p>
手で書くCと変わりない実行効率
</p>

<p>
他の言語とリンクできるバイナリ互換
</p>

<p>
線形探索より複雑なアルゴリズムを使わず実装可能
</p>
</section>

<section>
<h2>1982年</h2>

<p>
C with Classesは複数のプロジェクトで使われるようになった
</p>

<p>
これより進化させるには、本物の言語として、新たに設計と実装が必要
</p>

<p>
得られた経験をもとに、新しい言語C++を作る
</p>
</section>

<section>
<h2>C++という名前</h2>

<p>
Rick Mascittiが提案
</p>

<p>
元ネタはK&amp;RのC言語
</p>

<p>
その元ネタはMartin RichardsのBCPL
</p>

<p>
さらに元ネタはKen TompsonのB言語
</p>
</section>

<section id="CFront">
<h2>CFront</h2>

<p>
StroustrupによるC++のリファレンス実装
</p>

<p>
移植性を重視
</p>

<p>
C++の完全なコンパイラー
</p>

<p>
無料
</p>
</section>

<section>
<h2>リファレンス実装</h2>

<p>
C++の設計と進化のための実装
</p>

<p>
ツールとしては貧弱
</p>

<p>
C++が十分に普及すれば独立した実装が出るはず
</p>

<p>
それまでの間、動く実装を提供
</p>
</section>

<section id="portability">
<h2>移植性</h2>

<p>
世の中にはコンピューターの種類が多すぎる
</p>

<p>
名前すら聞いたことのないようなOSがある
</p>

<p>
アセンブリや中間コードを出力したのでは対応しきれない
</p>

<p>
C言語コンパイラーはほとんどの環境にあり、移植性が高い
</p>

<p>
Cコードを出力
</p>
</section>

<section>
<h2>完全なコンパイラー</h2>

<p>
CPP済みのC++コードを受け取る
</p>

<p>
パース、内部表現に変換、解析、Cコードで出力
</p>

<p>
単なるプリプロセッサーではない
</p>
</section>

<section>
<h2>無料</h2>

<p>
C++普及のために必要
</p>

<p>
多くの自称良いツールは
</p>

<ol>
<li>高価で買えない</li>
<li>動作するコンピューターも高価で買えない</li>
<li>しかも販売開始は常に「来年」</li>
</ol>

</section>

<section>
<h2>商用の需要</h2>

<p>
多くの教授が、商用コンパイラーを要求した
</p>

<ul>
<li>
業界で使える
</li>

<li>
コンサルできる
</li>
</ul>

<p>
そこで商用版も発売した
</p>

<p>
結果、CFrontの改変版が各社から発売
</p>
</section>

<section>
<h2>ジェネリックプログラミング</h2>

<p>
アルゴリズムとデータ構造は<br>
特定の型やバイト列とは独立して実装できる
</p>

<p>
オブジェクトのサイズや、構築やコピー方法さえ引数化できれば<br>
後は汎用的に実装できるはず
</p>
</section>

<section>
<h2>汎用化できる例</h2>

<pre><code data-trim="data-trim" class="cpp">
int min( int x, int y )
{ return x &lt; y ? x : y ; }

double min( double x, double y )
{ return x &lt; y ? x : y ; }
</code></pre>
</section>

<section>
<h2>汎用化できる例</h2>

<pre><code data-trim="data-trim" class="cpp">
struct int_list_node
{
    int value ;
    int_list_node * prev ;
    int_list_node * next ;
} ;
</code></pre>
</section>



<section>
<h2>プリプロセッサーは有害</h2>

<p>
プリプロセッサーは字句的に処理する
</p>

<p>
文法やスコープを考慮しない暴君
</p>

<p>
文法とスコープを尊重する機能がほしい
</p>
</section>

<section>
<h2>テンプレート</h2>

<p>
型を引数にできる機能
</p>

<pre><code data-trim="data-trim" class="cpp">
template &lt; typename T &gt;
T min ( T x, T y )
{ return x &lt; y ? x : y ; }
</code></pre>
</section>


<section>
<h2>汎用的なコンテナー</h2>

<p>
テンプレートはコンテナーを書くために設計された
</p>

<p>
コンテナーとは値の集合を管理するためのクラス
</p>

<p>
実装に使うデータ構造がどうあれ、操作は汎用化できる
</p>
</section>


<section>
<h2>STL</h2>

<p>
C++の標準ライブラリ
</p>

<p>
主にコンテナーとアルゴリズム
</p>

<p>
Alexander Stepanovが設計、実装
</p>
</section>


<section>
<h2>Adaでの挫折</h2>

<p>
Adaも早くからテンプレート機能を持っていた
</p>

<p>
Stepanovは、当初AdaでSTLの実装に挑戦
</p>


<p>
Adaの機能上の問題により挫折
</p>
</section>

<section>
<h2>C++で花開く</h2>

<p>
StepanovがC++にやってきた
</p>

<p>
C++でようやくSTL実装に成功
</p>
</section>

<section>
<h2>メタプログラミング</h2>

<p>
コンパイル時に行うプログラミング
</p>
</section>

<section>
<h2>起源</h2>

<p>
1994年、Erwin Unruhが標準化委員会で提示したテンプレートのコード
</p>

<p>
コード自体はコンパイルエラー
</p>

<p>
ただし、エラーメッセージが、素数のみ出力される
</p>

<p>
UnruhはC++における最初のメタプログラマーとなる
</p>
</section>


<section>
<h2>思わぬ誤算</h2>

<p>
Unruhの意図
</p>

<p>
テンプレートはコンパイル時プログラミングを行えるほど複雑である
</p>

<p>
ゆえに、もっと制限を加えるべき
</p>

<p>
大多数の標準化委員会の感想
</p>

<p>
「すばらしいものだ」
</p>
</section>

<section>
<h2>メタプログラミングの繁栄</h2>

<p>
その後、多くのメタプログラミング技法が発見される
</p>

<p>
メタプログラミングをサポートするための機能が多く追加される
</p>

<p>
今後も発展が期待される
</p>
</section>


<section id="standard">
<h2>標準規格とは？</h2>

<p>
理想
</p>

<p>
あるプログラムが合法か違法か決定できるもの
</p>

<p>
現実
</p>

<p>
C++では、すべてのプログラムに白黒をつけることができない
</p>
</section>

<section>
<h2>定められない挙動の例</h2>

<ul>
<li>
int型の具体的なビット数
</li>
<li>
浮動小数点数の実装方法
</li>
<li>
ゼロ除算
</li>
</ul>
</section>

<section>
<h2>目的</h2>

<p>
C++の標準規格を制定する
</p>

<p>
C++の分裂を防ぐ
</p>
</section>

<section>
<h2>実装依存</h2>

<p>
ある種の挙動は規定せずに実装にまかせる
</p>
</section>

<section>
<h2>D&amp;E時代の標準化委員会</h2>

<p>
ANSIとISOがある
</p>

<p>
下院(ANSI)と上院(ISO)のような関係
</p>
</section>

<section>
<h2>ANSI</h2>

<p>
ほとんどの規格制定はANSIで行う
</p>

<p>
議論、提案、文面変更など
</p>

<p>
メンバーはたいてい企業の代表
</p>

<p>
投票権はひとつの企業につき一票
</p>

<p>
特定の企業を代表しない個人も一票
</p>

<p>
年三回ほど、一週間の会議が開かれる。
</p>
</section>

<section>
<h2>ISO</h2>

<p>
ANSIの作業結果を投票により承認する
</p>

<p>
主要な各国に支部がある
</p>

<p>
投票権は、ひとつの国につき一票
</p>
</section>

<section>
<h2>規格制定の流れ</h2>

<ol>
<li>
ANSIがCDを出す
</li>
<li>
ISOの各国支部がNBコメントを出す
</li>

<li>
1.に戻る
</li>
</ol>

<p>
最終的に、FCDを出す
</p>

<p>
ISOの各国支部が投票する。
</p>

<p>
可決されれば規格制定
</p>

<p>
慣習的に、規格制定は全員一致
</p>

</section>

<section>
<h2>用語</h2>

<dl>
<dt>CD</dt>
<dd>
Committee Draft、委員会による規格案
</dd>

<dt>FCD</dt>
<dd>
Final Committee Draft、正式規格とほぼ変わらない文面案
</dd>

<dt>NBコメント</dt>
<dd>
National Body Comment、各国支部による意見
</dd>

</dl>
</section>

<section>
<h2>現在の状況</h2>

<p>
ドラフト編集作業では、特に国籍にはこだわらない
</p>
<p>
アメリカの標準団体が強権を発揮することもない
</p>

<p>
関心のある企業、グループ、個人が提案
</p>

<p>
議論、文面案作成、ドラフト入り
</p>

<p>
新機能の提案を会議のために準備し、会議で可決される
</p>

</section>

<section>
<h2>現在の規格制定</h2>

<p>
CDに対して各国支部が国を代表するNBコメントを出す
</p>

<p>
最終的な投票も一国一票
</p>

<p>
慣習的に全国一致で規格制定
</p>

<p>
投票権というよりは拒否権
</p>

<p>
はやく正式な規格が制定されてほしいという利害は一致
</p>

<p>
十分に妥協できるところで規格制定
</p>
</section>


<section>
<h2>現在の会議以外の活動</h2>

<p>
会議以外の議論は非公開のメーリングリスト
</p>

<p>
非公開の理由は、積極的な議論を促すため
</p>

<p>
しかし、今の時代には閉鎖的
</p>
</section>

<section>
<h2>開かれた議論へ</h2>

<p>
C++の標準化と啓蒙を目的とした<a href="http://isocpp.org/">C++財団</a>を設立
</p>

<p>
誰でも参加できる<a href="http://isocpp.org/forums">メーリングリスト</a>を設置
</p>

<p>
それまで納期ごとに一括公開していた論文を、逐一公開
</p>

<p>
その他、C++の教育記事執筆など
</p>
</section>

<section>
<h2>ドラフト規格をGitHubに</h2>

<p>
C++のドラフト規格のソースコード(tex)をGitHubで公開
</p>

<p>
Pull Requestも絶賛受付中
</p>

<p>
<a href="https://github.com/cplusplus/draft">cplusplus/draft</a>
</p>
</section>





<section id="Cpp-WG-JP">
<h2>C++ Working Group Japan</h2>

<p>
ISOのC++WGの日本支部
</p>

<p>
日本を代表して意見と投票を行う
</p>
</section>

<section>
<h2>設立</h2>

<p>
1990年、1991年頃
</p>

<p>
C++WG JP設立前にも私的な会議が何度か行われていた
</p>

<p>
慶応SFCの斎藤信夫先生が設立に尽力
</p>


<p>
「日本でも標準化にコミットするための委員会をつくろうと思う」
</p>

<p>
斎藤信夫先生が初代主査
</p>

</section>

<section>
<h2>C++WG JPの組織</h2>

<p>
日本の<a href="http://www.itscj.ipsj.or.jp/hyojunka/h_sn_member/h_sn_member_01.html">情報規格調査会</a>傘下
</p>



<dl>
<dt>委員</dt>
<dd>
企業のスポンサーを受けた代表で投票権を持つ
</dd>

<dt>エキスパートメンバー</dt>
<dd>
スポンサーを持たない個人で投票権を持たない
</dd>
</dl>

<p>
その他、規定ではオブザーバーやメールメンバーもあるらしい
</p>

<p>
ただし、C++WG JPではそのような肩書のメンバーはいない
</p>
</section>


<section id="ECpp">
<h2>EC++という黒歴史</h2>

<p>
複雑になりすぎたC++のサブセットを作ろうという日本の動き
</p>

<p>
実装が簡単でオーバーヘッドのないサブセット
</p>


<p>
C++WG JPとは独立した業界団体
</p>

<p>
8-bit, 16-bitマイコンでも使えるC++のサブセットの規定
</p>


<p>
1995年11月10日に第一回会議が行われる
</p>

</section>


<section>
<h2>参加者</h2>


<p>
NEC、日立、富士通、松下、三菱、日本モトローラ、東芝の半導体部門の開発ツール担当者
</p>

<p>
ツールベンダ
</p>

<p>
Cygnus,GreenHills,PlumHall,Dinkumware,ADaC,
日本ノーベル,横河YDC
</p>
</section>

<section>
<h2>Stroustrupは感心せず</h2>
<p>
C++に独占権利を主張するわけではないが・・・
</p>

<p>
言語の分裂は利用者も分断してしまう
</p>

<p>
どうせやるならば、標準化委員会で議論してはどうかと提案
</p>
</section>

<section>
<h2>EC++が標準化員会に</h2>

<p>
EC++団体が標準化委員会に合流
</p>

<p>
国際会議で提案を発表
</p>

<p>
しかし、ゼロオーバーヘッドで実装できるとの反論多数
</p>

<p>
反論がPerformance TRとしてまとめられる。
</p>
</section>

<section>
<h2>EC++失敗</h2>

<p>
日本独自のよくわからない理由で機能削減されたサブセット規格
</p>

<p>
各社独自の閉鎖的な環境で開発されたコンパイラー
</p>

<p>
プラットフォームは非力なマイコン
</p>

<p>
使われるわけがない
</p>

</section>

<section>
<h2>C++WG JP冬の時代</h2>

<p>
2000年代から、存続の危機に
</p>
</section>


<section>
<h2>スポンサー不足</h2>

<p>
既存のスポンサーはEC++のコンパイラー実装のため
</p>

<p>
余裕のある一部大企業を除いてスポンサー大量離脱
</p>

<p>
その一部大企業も、もはや標準化委員会の籍をおいているだけ
</p>

<p>
国際会議はおろか、国内会議にも出席せず
</p>

</section>

<section>
<h2>教育者不足</h2>

<p>
2005年
</p>

<p>
C++WG JPに籍をおいていた最後の教育関係者にして二代目の主査が逝去
</p>

<p>
東京工科大学の越田一郎先生
</p>


<p>
以降、C++WG JPに教育関係者なし
</p>

<p>
しばらく主査は東芝の林田が担当
</p>

<p>
現在の主査は日本アイ・ビー・エムの安室
</p>
</section>

<section>
<h2>人材不足</h2>

<p>
2006年
</p>

<p>
もはや国際会議に日本代表を送るスポンサーがいない
</p>

<p>
国内会議にも3,4人しか出てこない
</p>
</section>

<section>
<h2>存続の危機</h2>

<p>
2006年
</p>

<p>
スポンサー、教育者、人、何もかもが不足
</p>

<p>
国内活動すらままならない
</p>

<p>
このままでは存続すら危うい
</p>
</section>

<section>
<h2>生き残りをかけた勧誘</h2>

<p>
日本を代表して意見表明するC++WG JPを残さなければならない
</p>

<p>
せめて、人材だけは維持しなければならない
</p>

<p>
人づてにエキスパートメンバーを勧誘
</p>

<p>
エキスパートメンバーが大幅に増える
</p>

<p>
個人に年会費などはない
</p>
</section>


<section>
<h2>いびつな勢力図</h2>

<p>
極小数のスポンサーつき委員
</p>

<p>
圧倒的多数の活動的なスポンサーなし個人
</p>

<p>
いびつながらも国内会議が続けられるように
</p>

<p>
C++WG JP存続
</p>
</section>

<section>
<h2>国内会議</h2>

<p>
国際会議でドラフト入りした提案論文のレビュー
</p>

<p>
レビュー：論文を全訳して問題点の洗い出し
</p>

<p>
NBコメントの取りまとめと議論
</p>
</section>

<section>
<h2>スポンサー離れの弊害</h2>

<p>
C++03までは、規格の日本語訳をJIS規格として出していた
</p>

<p>
人と金を出すスポンサーからの要請
</p>

<p>
今はスポンサーもいない
</p>

<p>
大多数の人も義務のないスポンサーなしの個人
</p>

<p>
C++11のJIS規格のための翻訳が行われない
</p>

<p>
C++11以降は、会議すら行われない
</p>
</section>

<section>
<h2>新しい動き</h2>

<p>
標準化委員会の会議は、メンバーしか参加できない
</p>

<p>
会議には、場所の確保やら議事録の作成やら、事務仕事が多い
</p>

<p>
しかし、大多数のメンバーはスポンサーを持たない個人
</p>

<p>
なぜそんな閉鎖的な会議にするのか？
</p>
</section>

<section>
<h2>勉強会という名の会議</h2>

<p>
委員会の外の非公式な勉強会
</p>

<p>
費用はほとんどかからない
</p>

<p>
委員会外からも参加者を募れる
</p>

<p>
最近の活動は、もっぱら非公式勉強会
</p>

<p>
東京在住のエキスパートメンバーが主催
</p>
</section>



<section>
<h2>参考文献</h2>

<ul>

<li>
<a href="http://www.stroustrup.com/hopl2.pdf">Stroustrup 1993: HOPL-2</a>
</li>

<li>
<a href="http://www.stroustrup.com/dne.html">Stroustrup 1994: The Design and Evolution of C++</a>
</li>

<li>
<a href="http://www.stroustrup.com/hopl-almost-final.pdf">Stroustrup 2007: HOPL-III</a>
</li>

</ul>
</section>

<section>
<h2>参考人</h2>

<p>
足立 高徳(ARMを翻訳した人)
</p>

<p>
林田 誠司(東芝)
</p>
</section>

</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->


<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>

<script>

    // fire up the Reveal.js 
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        width : "90%",
        height : "90%",

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries
        dependencies: [
            { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
            { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
            { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
    });

</script>


</body>

</html>
